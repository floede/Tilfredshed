function init(){var a=document.querySelector("#pos-template"),b=document.querySelector("#neut-template"),c=document.querySelector("#neg-template");tilfredshedRef.on("value",function(d){reasons=d.val();var e=[];sortVotes(e,reasons.positives),a.positives=e;var f=[];sortVotes(f,reasons.neutrals),b.neutrals=f;var g=[];sortVotes(g,reasons.negatives),c.negatives=g})}function sortVotes(a,b){for(var c in b)b.hasOwnProperty(c)&&(b[c].weight=getWeight(b[c].votes),b[c].id=c,a.push(b[c]));return SortByWeight(a),a}function getWeight(a){return count=0,$.each(a,function(b){if(a[b]){var c=moment(a[b].date,"YYYYMMDD"),d=10-now.diff(c,"days");d>0&&(count+=d)}}),weight=count>=100?1:count/100}function SortByWeight(a){a.sort(function(a,b){return b.weight-a.weight})}var now=moment(),tilfredshedRef=new Firebase("https://tilfredshed.firebaseio.com/"),tilfredshedPosRef=new Firebase("https://tilfredshed.firebaseio.com/positives/"),tilfredshedNegRef=new Firebase("https://tilfredshed.firebaseio.com/negatives/"),tilfredshedNeutRef=new Firebase("https://tilfredshed.firebaseio.com/neutrals/");$(document).ready(function(){init()});